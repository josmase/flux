---
apiVersion: v1
kind: ConfigMap
metadata:
  name: alertmanager-gotify-template
  namespace: monitoring
data:
  gotify.tmpl: |
    {{ define "gotify.message" }}
    {{- range .Alerts }}
    **{{ .Labels.alertname }}** - {{ .Status }}
    {{- if .Annotations.summary }}
    {{ .Annotations.summary }}
    {{- end }}
    {{- if .Annotations.description }}
    {{ .Annotations.description }}
    {{- end }}
    Labels: {{ range .Labels.SortedPairs }}{{ .Name }}={{ .Value }} {{ end }}
    {{- end }}
    {{ end }}

    {{ define "gotify.title" }}
    {{- if eq .Status "firing" -}}
    ðŸ”¥ {{ .Alerts | len }} Alert(s) Firing
    {{- else -}}
    âœ… {{ .Alerts | len }} Alert(s) Resolved
    {{- end -}}
    {{ end }}
